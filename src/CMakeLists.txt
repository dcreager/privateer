# -*- coding: utf-8 -*-
# ----------------------------------------------------------------------
# Copyright Â© 2011, RedJack, LLC.
# All rights reserved.
#
# Please see the LICENSE.txt file in this distribution for license
# details.
# ----------------------------------------------------------------------

include_directories(${CMAKE_SOURCE_DIR}/include)
include_directories(${CMAKE_BINARY_DIR}/include)


#-----------------------------------------------------------------------
# libprivateer

set(LIBPRIVATEER_SRC
    libprivateer/registry.c
)

add_library(libprivateer SHARED ${LIBPRIVATEER_SRC})
set_target_properties(libprivateer PROPERTIES
    OUTPUT_NAME privateer
    SOVERSION 0.0.0)
target_link_libraries(libprivateer
    dl
    ${YAML_LIBRARIES}
    ${CORK_LIBRARIES}
    ${CLOG_LIBRARIES}
)

install(TARGETS libprivateer DESTINATION lib)


#-----------------------------------------------------------------------
# libprivateer-tests

set(LIBPRIVATEER_TESTS_SRC
    libprivateer-tests/alpha.c
    libprivateer-tests/beta.c
    libprivateer-tests/gamma.c
)

add_library(libprivateer-tests SHARED ${LIBPRIVATEER_TESTS_SRC})
set_target_properties(libprivateer-tests PROPERTIES
    OUTPUT_NAME privateer-tests
    SOVERSION 0.0.0)
target_link_libraries(libprivateer-tests
)


#-----------------------------------------------------------------------
# privateer

set(PRIVATEER_SRC
    privateer/privateer.c
)

add_executable(privateer ${PRIVATEER_SRC})
target_link_libraries(privateer libprivateer libprivateer-tests)


#-----------------------------------------------------------------------
# Generate the pkg-config file

set(prefix ${CMAKE_INSTALL_PREFIX})
configure_file(privateer.pc.in privateer.pc @ONLY)
install(FILES ${CMAKE_CURRENT_BINARY_DIR}/privateer.pc
        DESTINATION lib/pkgconfig)
